---
title: SELinux Permissions
categories:
- sysadmin
date: 2019-12-30
layout: post
---

SELinux (Security Enhanced Linux) is a linux kernel security module that provides a mechanism for supporting access control policies. This can support the protection from tampering and bypassing threats that might be possible with certain applications.

A Linux kernel that uses SELinux enforces mandatory access control policies that confine user programs and system services, also including file and network resources. If a program or daemon becomes compromised in an SELinux kernel space, then it is confined and limits the damage that can be caused.

SELinux users and roles do not have to be related to the actual system users and roles. For every current user or process, SELinux assigns a three string context consisting of username, role and domain (or type). This system is more flexible than normally required.

#### Working with SELinux Modes
SELinux has three modes:
- Enforcing: Rules are enforced and violations are logged
- Permissive: No rule enforcement, violations logged
- Disabled: SELinux is not operational and no logging is enabled

To find out which mode the current system is in:

    sestatus

You can also find out the config with:

    cat /etc/selinux/config

(or, whatever SELinux root directory was identified in the previous command).

Changing any of the settings in the above file will need a restart.

To see the SELinux status of any particular file, pass the ```-Z``` flag to ```ls```:

    ls -Z somefile 

Type:

    setenforce 0

which will turn off the enforce, but a reboot means that this will be ignored and a reboot would be in enforced mode. 

You can also pass ```enforcing=0``` on a grub command line (the line that loads the kernel) to change to permissive mode. This helps if there is difficulty in logging in. 

To change mode over a reboot edit /etc/selinux/config:

   SELINUX=permissive

Now, when you look at status, you will see that both config file and current mode are permissive.

```setenforce``` can only be set with ```enforced``` or ```permissive``` on the command line.' ```disabled``` is allowed in the configuration file. 


#### Controlling User Access

#### Type Enforcement Rules

#### Working with Booleans
Administrators can override SELinux enforced mode to get around problems. This can be a problem when you are trying to prevent opening up access. This can be prevented by requiring a reboot before a new mode is active. To do this you will need to set a boolean which prevents changing the mode without a reboot. 

    getsebool -a 

will show all the booleans that are in place for this runtime. The same can be achieved with:

    semanage boolean -l | grep secure_mode_policyload

To change this: 

    setsebool secure_mode_policyload on 
    getsebool -a |grep policy

The latter command confirms that the boolean is on. 
If you want the boolean to take place over a reboot:

    setsebool -P secure_mode_policyload on

The ```-P``` sets this to be transient over a reboot. 


#### Diagnosing SELinux Issues

#### Writing Custom Modules


