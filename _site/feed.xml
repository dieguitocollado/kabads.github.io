<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-01-01T12:56:05+00:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Kabads. Musings, mutterings and murmerings.</title><subtitle>I worked in education for 20 years and always had a hand in Technology.  I create cloud automation solutions with Infrastructure as Code.</subtitle><entry><title type="html">SELinux Users, Roles, and Types</title><link href="http://localhost:4000/sysadmin/2019/12/31/selinux-users-roles-types.html" rel="alternate" type="text/html" title="SELinux Users, Roles, and Types" /><published>2019-12-31T00:00:00+00:00</published><updated>2019-12-31T00:00:00+00:00</updated><id>http://localhost:4000/sysadmin/2019/12/31/selinux-users-roles-types</id><content type="html" xml:base="http://localhost:4000/sysadmin/2019/12/31/selinux-users-roles-types.html">&lt;p&gt;SELinux contexts follow the SELinux user:role:type:level syntax.&lt;/p&gt;

&lt;h3 id=&quot;users&quot;&gt;Users&lt;/h3&gt;

&lt;p&gt;Users can be seen with the command:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;semanage user -l
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will show the list of SELinux users, and is mapped to Linux users. If a Linux user is not listed then they are associated with the &lt;code class=&quot;highlighter-rouge&quot;&gt;__default_&lt;/code&gt; SELinux user and inherit those rights.&lt;/p&gt;</content><author><name></name></author><summary type="html">SELinux contexts follow the SELinux user:role:type:level syntax.</summary></entry><entry><title type="html">Setting Filesystem ACLs on Linux</title><link href="http://localhost:4000/sysadmin/2019/12/30/setting-acl-linux-filesystem.html" rel="alternate" type="text/html" title="Setting Filesystem ACLs on Linux" /><published>2019-12-30T00:00:00+00:00</published><updated>2019-12-30T00:00:00+00:00</updated><id>http://localhost:4000/sysadmin/2019/12/30/setting-acl-linux-filesystem</id><content type="html" xml:base="http://localhost:4000/sysadmin/2019/12/30/setting-acl-linux-filesystem.html">&lt;p&gt;ACLs are a method for defining access to files and directories on a system. These can be set at the user level, group level, or via the effective rights mask.&lt;/p&gt;

&lt;p&gt;The commands &lt;code class=&quot;highlighter-rouge&quot;&gt;getfacl&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;setfacl&lt;/code&gt; are used to get and change ACL permissions respectively. If you are setting for a specific user then the text form of the attribute is &lt;code class=&quot;highlighter-rouge&quot;&gt;user:username:rwx&lt;/code&gt;. If you want the permission to apply to the default user (or group) then you would use the text term &lt;code class=&quot;highlighter-rouge&quot;&gt;user::rwx&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;To check the status of any extended Access Control Lists:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;getfacl filename
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To update a file access control list, you would use:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setfacl -m u:lisa:r filename
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This would give the user &lt;code class=&quot;highlighter-rouge&quot;&gt;lisa&lt;/code&gt; read access to the file.&lt;/p&gt;

&lt;p&gt;Where a user is specified, this can also be done for a group:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setfacl -m g:wheel:r filename
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To remove access from a file:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setfacl -x filename
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that this will remove all extended permissions from that file.&lt;/p&gt;

&lt;p&gt;To remove just one access control use the &lt;code class=&quot;highlighter-rouge&quot;&gt;-&lt;/code&gt; character:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setfacl -m u:lisa:r-x filename
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By adding an &lt;code class=&quot;highlighter-rouge&quot;&gt;-R&lt;/code&gt; flag, an ACL is applied recursively (i.e. to directories and files below the path specified).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;setfacl -R -m u:lisa:rwx directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will provide read, write and execute to the directory &lt;code class=&quot;highlighter-rouge&quot;&gt;directory_name&lt;/code&gt; and any files within that directory.&lt;/p&gt;</content><author><name></name></author><summary type="html">ACLs are a method for defining access to files and directories on a system. These can be set at the user level, group level, or via the effective rights mask.</summary></entry><entry><title type="html">Learning Ruby - First Impressions</title><link href="http://localhost:4000/ruby/2019/06/16/learning-ruby-part-1.html" rel="alternate" type="text/html" title="Learning Ruby - First Impressions" /><published>2019-06-16T00:00:00+01:00</published><updated>2019-06-16T00:00:00+01:00</updated><id>http://localhost:4000/ruby/2019/06/16/learning-ruby-part-1</id><content type="html" xml:base="http://localhost:4000/ruby/2019/06/16/learning-ruby-part-1.html">&lt;p&gt;Chef is used in my place of work, and so as a result I started learning &lt;a href=&quot;https://www.ruby-lang.org&quot;&gt;Ruby programming language&lt;/a&gt;. &lt;img src=&quot;https://live.staticflickr.com/65535/48072657641_7545908162_m.jpg&quot; width=&quot;180&quot; height=&quot;156&quot; alt=&quot;ruby-icon&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I know some python (enough to get me by) but thought that knowing some Ruby would be a good development in my learning. This is an attempt an my first impressions of what is good for a beginner and what is not so good (from the perspective of someone coming from Python).&lt;/p&gt;

&lt;h4 id=&quot;good-points&quot;&gt;Good Points&lt;/h4&gt;

&lt;p&gt;Ruby is super easy to pick up and get going. Declaring methods and passing variables just works. Casting from one type of variabl to another just seems to happen seemlessly. Some beginners have this problem in Python, but Ruby removes all this worry from the developer and it &lt;em&gt;just works&lt;/em&gt; (I’m expecting Pythonistas to hate on me here, as it does work flawlessly in Python, but feels more complex to me). Also, the &lt;a href=&quot;https://ruby-doc.org/core-2.6.3/Enumerable.html&quot;&gt;.each&lt;/a&gt; method is really nice. Being able to do this, just feels good:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;array.each do |item|
   item.do_some_stuff
end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This makes sense and does read really well.&lt;/p&gt;

&lt;p&gt;I really like the string interpolation - again, from a beginner’s perspective, this just works out of the box and makes sense:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;name = &quot;Alfie Spoons&quot;
puts &quot;Hello #{name}.&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The way this works so intuitively, helped me realise that this was designed with the developer in mind.&lt;/p&gt;

&lt;p&gt;I usually try to write a few simple programs before I make a judgement - these usually include a command line calcultor (which takes two numbers and an operator and then checks them and goes through the obligatory operator check to work out which function/method needs to receive the two numbers). Another one is a ‘guess the number’ game, where a random number is created andthen the user has to try and guess it with the fewest guesses (guesses being counted), whilst the only feedback is “You guessed too high/low”. For this I really liked the concept of:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;win = false 
until win do
    ....
end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Again, this feels intuitive. I know this can be done with a while, but the command until kind of makes sense.&lt;/p&gt;

&lt;h4 id=&quot;quirks&quot;&gt;Quirks&lt;/h4&gt;

&lt;p&gt;Not everything is that great - there is always a downside to a language. In this case it’s blocks. Now, I’m not sure if I understand code blocks at the moment, when compared to Python functions. I think they are similar to functions, and they work with the command yield (so they can be passed around), but they are not quite as intuitive as passing around a function in Python (where it really is that easy to pass a function in to code as though it’s a variable.&lt;/p&gt;

&lt;p&gt;Also, when working with a virtual environment (the equivalent of venv in Python), it doesn’t feel like you are in a new environment, when Python makes it clear that you have new environment variables. This is what made me give up on the blogging platform &lt;a href=&quot;https://www.jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; as installing it became a pain with its dependencies that would mess up other applications that I used. However, since &lt;a href=&quot;https://bundler.io&quot;&gt;bundler&lt;/a&gt; has been developed and introduced, it’s easier now to run different commands with a bundle of depenedencies.&lt;/p&gt;</content><author><name></name></author><summary type="html">Chef is used in my place of work, and so as a result I started learning Ruby programming language.</summary></entry><entry><title type="html">Chernobyl - A Review</title><link href="http://localhost:4000/2019/06/11/chernobyl-a-review.html" rel="alternate" type="text/html" title="Chernobyl - A Review" /><published>2019-06-11T19:52:22+01:00</published><updated>2019-06-11T19:52:22+01:00</updated><id>http://localhost:4000/2019/06/11/chernobyl-a-review</id><content type="html" xml:base="http://localhost:4000/2019/06/11/chernobyl-a-review.html">&lt;p&gt;Chernobyl has screened on Sky Atlantic over the last few weeks. It represents a dramatic representation of the disaster back in 1986, which for a lot of people, is still in living memory.&lt;/p&gt;

&lt;p&gt;The people who staffed the reactor experienced an explosion during a test around 1:25am. They didn’t expect this to happen. The whole incident led to an explosion that devastated the surrounding areas with radioactive contamination. This acts as the backdrop for the drama written by Craig Mazin. The plot unfolds from a wide range of angles, from those who live nearby, to miners who are trucked in to stop the radiation leaking in to the ground under the reactor. Each story is driven with a personal narrative, and the desperation of the situation soon unfolds.&lt;/p&gt;

&lt;p&gt;For those people who were watching the news at the time, things did look bleak and uncertain as to what would happen. The film allows us to see things that we couldn’t see at the time due to the secret nature of the Soviet Union. The authorities at the time wanted to cover up the way the reactor had been engineered, which led to the disaster. All of this is beautifully, yet hauntingly revealed to us through the film. Paul Ritter does a sterling job of playing the part of Dyatlov, the engineer who was in denial early on that anything bad had happened, and ordered his colleague to go and have a look at the reactor to report back on how it looked.&lt;/p&gt;

&lt;p&gt;However well Ritter did in his role, he would not be able to surpass Jared Harris, who played the scientist Legasov called in to help deal with the clean up and the reporting of the problem. His personal anguish is evident as the nature of the events unfold.&lt;/p&gt;

&lt;p&gt;Teams of military are portrayed in the ‘most dangerous place on Earth’ as they clean up the debris on the roof of the exploded reactor building. Wild animals are ‘controlled’ as they…&lt;/p&gt;

&lt;p&gt;To top this, the direction and attention to detail, really pays this medium justice as it feels like you are really watching the events as they happened. This is a testament to those people who really were there. Had this drama been hammed up in any way, it would have disrespected their personal sacrifice. Unfortunately, this film had to be made, but hopefully the lessons from it will mean that as a species, we don’t have to face anything like this again.&lt;/p&gt;</content><author><name></name></author><summary type="html">Chernobyl has screened on Sky Atlantic over the last few weeks. It represents a dramatic representation of the disaster back in 1986, which for a lot of people, is still in living memory.</summary></entry><entry><title type="html">Setting Up Fujitsu Snapscan S1300i on Arch Linux</title><link href="http://localhost:4000/sysadmin/2019/03/10/using-fujitsu-snapscan-s1300i-on-arch.html" rel="alternate" type="text/html" title="Setting Up Fujitsu Snapscan S1300i on Arch Linux" /><published>2019-03-10T18:15:30+00:00</published><updated>2019-03-10T18:15:30+00:00</updated><id>http://localhost:4000/sysadmin/2019/03/10/using-fujitsu-snapscan-s1300i-on-arch</id><content type="html" xml:base="http://localhost:4000/sysadmin/2019/03/10/using-fujitsu-snapscan-s1300i-on-arch.html">&lt;p&gt;I have bought a Fujitsu Snapscan S1301i scanner - mainly because it is duplex - it saves a lot of time and will scan directly to Evernote. So far, I’m pleased with it, but the initial thought when I got it home was, ‘how am I going to get it working with Arch Linux?’ &lt;!--more--&gt;&lt;/p&gt;

&lt;p&gt;Fujitsu Scansnap 1300i is supported by Sane, but does require a little bit of tinkering. You need the file 1300i_0D12.nal - which is only available from installing the file on a windows machine. If you wish to download it, you can from this &lt;a href=&quot;https://drive.google.com/open?id=1X7fUpu6cM4ow_D9QqAKVvHIGVWOmhvK7&quot;&gt;GDrive link&lt;/a&gt; - put that file in the directory /usr/share/sane/epjitsu (on Arch Linux).&lt;/p&gt;

&lt;p&gt;Now, edit the /etc/sane.d/epjitsu.conf file - you need to include the settings found at http://www.sane-project.org/cgi-bin/driver.pl?manu=fujitsu&amp;amp;model=scansnap&amp;amp;bus=any&amp;amp;v=&amp;amp;p= 0x04c5/0x128d -&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Fujitsu S1300i
firmware /usr/share/sane/epjitsu/1300i_0D12.nal
usb 0x04c5 0x128d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once you’ve done this, you may need to test the config with superuser rights (sudo gscan2pdf).&lt;/p&gt;

&lt;p&gt;Running gscan2pdf will present you with a choice of scanners - for some reason gscan2pdf picks up my in built camera, which I change to the Fujitsu. To scan duplex you will need to change the settings to standard_tab &amp;gt; scan source_dropdown= ADF- Duplex.&lt;/p&gt;</content><author><name></name></author><summary type="html">I have bought a Fujitsu Snapscan S1301i scanner - mainly because it is duplex - it saves a lot of time and will scan directly to Evernote. So far, I’m pleased with it, but the initial thought when I got it home was, ‘how am I going to get it working with Arch Linux?’</summary></entry><entry><title type="html">Setting Up MySQL Replication as a back-up solution</title><link href="http://localhost:4000/sysadmin/2018/08/27/setting-up-mysql-replication.html" rel="alternate" type="text/html" title="Setting Up MySQL Replication as a back-up solution" /><published>2018-08-27T13:32:30+01:00</published><updated>2018-08-27T13:32:30+01:00</updated><id>http://localhost:4000/sysadmin/2018/08/27/setting-up-mysql-replication</id><content type="html" xml:base="http://localhost:4000/sysadmin/2018/08/27/setting-up-mysql-replication.html">&lt;p&gt;MySQL replication is a good thing to have. It provides greater resilience and removes a single point of failure. By following these steps, you will create a replica of a master server, acting as a permanent backup in the case of a DR scenario.&lt;/p&gt;

&lt;h3 id=&quot;introduction&quot;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;MySQL servers can be a single point of failure if you have not set up a good back-up infrastructure. It is difficult to get a good back-up infrastructure in place, without some time spent out of service. However, a MySQL replication server avoids this downtime.&lt;/p&gt;

&lt;p&gt;One server will act as the master, and the other will act as slave. The slave will be paused and then backed up.&lt;/p&gt;

&lt;h3 id=&quot;benefits-of-running-a-replicated-mysql-server&quot;&gt;Benefits of running a replicated MySQL server:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Remove single point of failure adding high availability&lt;/li&gt;
  &lt;li&gt;Improved performance if applications can use the read-only server (think data querying)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://s3.eu-west-2.amazonaws.com/kabads.monkeez.org/images/mysql_replication.png&quot; alt=&quot;Master/Slave Server diagram&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;conifgure-the-master-mysql-server&quot;&gt;Conifgure the Master MySQL server&lt;/h3&gt;
&lt;p&gt;The master is the live database that is serving your users. To back this up on it’s own, you will have to stop transactions on the server and then carry out the backup. In a lot of high availability environments, this is not an option. However, you can prepare your master MySQL server to send those transactions to a different server.&lt;/p&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/my.conf&lt;/code&gt; add the following lines:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;log-bin       = master-bin
log-bin-index = master-bin.index
server-id      = 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;log-bin&lt;/code&gt; directive tells mysql to store a binary log. This binary log is what makes replication easy and quick. We also have a &lt;code class=&quot;highlighter-rouge&quot;&gt;log-index&lt;/code&gt;. The binary log tells the other server the events that are happening on the master server.&lt;/p&gt;

&lt;p&gt;You can watch the binary log file with the mysql prompt with &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOW BINLOG EVENTS\G;&lt;/code&gt;. However, to find out which binlog file is currently being written to you should enter &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOW MASTER STATUS;&lt;/code&gt; and then &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOW BINLOG EVENTS IN 'master-bin.000002'\G;&lt;/code&gt; (or whatever file was returned from the master status command.&lt;/p&gt;

&lt;p&gt;If you added the replication config lines above after creating the server, as opposed to when you first set the server up, you will need to restart the mysql server:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;service mysql-server restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then you will need to login to the MySQL command prompt:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Next, it is good practise to create a user for replication that only has access rights for the IP range for the subnet where the slave server is.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CREATE USER repl_user; 
GRANT REPLICATION SLAVE ON *.*
TO repl_user IDENTIFIED BY 'password';
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This user will have access to retrieve the binary log from the master server.&lt;/p&gt;

&lt;h3 id=&quot;configuring-the-mysql-slave-server&quot;&gt;Configuring the MySQL slave Server&lt;/h3&gt;

&lt;p&gt;Again, we need a user that has certain privileges on the slave server.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;GRANT REPLICATION, SLAVE, RELOAD, CREATE USER, SUPER ON *.* TO user@'1.2.3.%' WITH GRANT OPTION;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Next, you will have to log in to the slave mysql server and issue the following command:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;CHANGE MASTER TO MASTER_HOST = '1.2.3.4', MASTER_PORT = 3306, MASTER_USER = 'repl_user', MASTER_PASSWORD = 'password';
START SLAVE;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Any changes for new databases on the master server will now be replicated on the slave server.&lt;/p&gt;

&lt;h3 id=&quot;enabling-replication-on-an-existing-database&quot;&gt;Enabling replication on an existing database&lt;/h3&gt;

&lt;p&gt;If you already have a database on the master server, that you also want to replicate, you will need to copy it over to the slave database.&lt;/p&gt;

&lt;p&gt;If the database is relatively small (i.e. less than 50MB), then the &lt;code class=&quot;highlighter-rouge&quot;&gt;mysqldump&lt;/code&gt; command will work. Shutdown the database first to ensure data integrity.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mysqldump -u root -p databasename &amp;gt; file.sql&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If the dataset is large, then it will be better to create an archive of the files and then transfer that over to the slave machine and restart the server there. Firstly, you should shutdown the mysql server.&lt;/p&gt;

&lt;p&gt;Then, on the slave server, copy the files in the database directory (usually &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/lib/mysql&lt;/code&gt;). You can then tar that and then copy to the slave server and extract there. If there are large differences between the configuration files between the servers, then this might not work.&lt;/p&gt;

&lt;h3 id=&quot;carry-out-the-backup&quot;&gt;Carry out the backup&lt;/h3&gt;
&lt;p&gt;Now that we have a slave, we can take point in time back-ups by stopping the slave and pausing transactions (although transactions are still ongoing on the master server).&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Shut down the server &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo service mysql-server stop&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Copy the data files to a secure off-site location (in this case, Amazon S3) &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo aws s3 sync --delete /var/lib/mysql s3://bucket-name/&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Restart the server &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo service mysql-service start&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><summary type="html">MySQL replication is a good thing to have. It provides greater resilience and removes a single point of failure. By following these steps, you will create a replica of a master server, acting as a permanent backup in the case of a DR scenario.</summary></entry><entry><title type="html">Configure Autofs on Arch Linux</title><link href="http://localhost:4000/sysadmin/2018/08/11/configure-autofs.html" rel="alternate" type="text/html" title="Configure Autofs on Arch Linux" /><published>2018-08-11T11:07:00+01:00</published><updated>2018-08-11T11:07:00+01:00</updated><id>http://localhost:4000/sysadmin/2018/08/11/configure-autofs</id><content type="html" xml:base="http://localhost:4000/sysadmin/2018/08/11/configure-autofs.html">&lt;p&gt;Autofs is a way of auto-mounting devices to a running system. Theses steps will walk through enabling it on an Archlinux system.&lt;/p&gt;

&lt;h1 id=&quot;what-is-autofs&quot;&gt;What is Autofs?&lt;/h1&gt;
&lt;p&gt;It mounts a filesystem that is not always connected (e.g. network or device). Once a connection is made to that device, then autofs will handle the mounting of that device. It can also handle unmounting of a device, if it becomes unavailable. &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/fstab&lt;/code&gt; automatically tries to mount during boot - however, it won’t try to mount once a device is connected after boot. You may boot whilst you have no network access - this means that you won’t be able to mount that device. However, autofs will look after that, once you connect to the network (after boot).&lt;/p&gt;

&lt;h1 id=&quot;install-the-package&quot;&gt;Install the package&lt;/h1&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pacman -S autofs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;configure-the-master-autofs&quot;&gt;Configure the master autofs&lt;/h1&gt;

&lt;p&gt;In the file &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/autofs/auto.master&lt;/code&gt; add:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/autofs		/etc/autofs/auto.misc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Each line in the file has three fields - the first two being mandatory, and the last being optional. The first is the mount-point - where will it get mounted. The second is the map-file that is a template. The last one is a time field.&lt;/p&gt;

&lt;p&gt;You can also pass the &lt;code class=&quot;highlighter-rouge&quot;&gt;--timeout=30&lt;/code&gt; at the end of the file which means it will be unmounted after that time of not being used.&lt;/p&gt;

&lt;h1 id=&quot;configure-the-automisc-file&quot;&gt;Configure the &lt;code class=&quot;highlighter-rouge&quot;&gt;auto.misc&lt;/code&gt; file&lt;/h1&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;usb     	-fstype=ntfs            :/dev/sdc2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Start the service to test:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl start autofs.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then enable so that it will run at boot:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl enable autofs. service 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You will need to attempt to use the filesystem for it to mount&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd /mnt/usb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the disc should mount.&lt;/p&gt;</content><author><name></name></author><summary type="html">Autofs is a way of auto-mounting devices to a running system. Theses steps will walk through enabling it on an Archlinux system.</summary></entry><entry><title type="html">Working with Terraform</title><link href="http://localhost:4000/sysadmin/2018/08/04/working-with-terraform.html" rel="alternate" type="text/html" title="Working with Terraform" /><published>2018-08-04T00:00:00+01:00</published><updated>2018-08-04T00:00:00+01:00</updated><id>http://localhost:4000/sysadmin/2018/08/04/working-with-terraform</id><content type="html" xml:base="http://localhost:4000/sysadmin/2018/08/04/working-with-terraform.html">&lt;p&gt;Terraform is a cloud orchestration scripting language. This allows the capturing of cloud infrastructure. Instead of relying on your network and resources to be sat whilst you work on other projects, by using terraform, you can tear-down your infrastructure and then create it again from where you left of (saving money on the infrastructure that would be incurring a cost).&lt;/p&gt;

&lt;p&gt;Another advantage is that what you are creating is a resource for the project that is reproducible. You can show the team the work that you’ve completed and even also create documentation alongside, or within the resorce.&lt;/p&gt;</content><author><name></name></author><summary type="html">Terraform is a cloud orchestration scripting language. This allows the capturing of cloud infrastructure. Instead of relying on your network and resources to be sat whilst you work on other projects, by using terraform, you can tear-down your infrastructure and then create it again from where you left of (saving money on the infrastructure that would be incurring a cost).</summary></entry><entry><title type="html">Sync Google Calendar With Org Agenda</title><link href="http://localhost:4000/sysadmin/emacs/2018/03/18/sync-google-calendar-with-org-agenda.html" rel="alternate" type="text/html" title="Sync Google Calendar With Org Agenda" /><published>2018-03-18T13:02:55+00:00</published><updated>2018-03-18T13:02:55+00:00</updated><id>http://localhost:4000/sysadmin/emacs/2018/03/18/sync-google-calendar-with-org-agenda</id><content type="html" xml:base="http://localhost:4000/sysadmin/emacs/2018/03/18/sync-google-calendar-with-org-agenda.html">&lt;p&gt;&lt;a data-flickr-embed=&quot;true&quot; href=&quot;https://www.flickr.com/photos/kabads/40931410022/in/datetaken/&quot; title=&quot;screen&quot;&gt;&lt;img src=&quot;https://farm1.staticflickr.com/790/40931410022_e1823676da.jpg&quot; width=&quot;500&quot; height=&quot;316&quot; alt=&quot;screen&quot; /&gt;&lt;/a&gt;&lt;script async=&quot;&quot; src=&quot;//embedr.flickr.com/assets/client-code.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;I use &lt;a href=&quot;https://orgmode.org&quot;&gt;org-mode&lt;/a&gt; an awful lot - it helps me manage my tasks and code all in one place. However, the organisation that I work for have just migrated over to Google Suite and manage meetings extensively using Google Calendar. I really wanted my Google Calendar to sync with my &lt;a href=&quot;https://orgmode.org/manual/Agenda-commands.html&quot;&gt;org-agenda&lt;/a&gt;. Org-agenda is a tool that pulls in any scheduled activities from all your files in to one dynamic view. It’s pretty much what drives my working day. Having meetings arranged with colleagues in my org-agenda will help me schedule my day.&lt;/p&gt;

&lt;p&gt;The package &lt;a href=&quot;https://github.com/myuhe/org-gcal.el&quot;&gt;org-gcal&lt;/a&gt; provides two way syncing with Google Calendar (and has other documentation).&lt;/p&gt;

&lt;p&gt;This is how I did it.&lt;/p&gt;

&lt;h2 id=&quot;install-org-cal&quot;&gt;Install org-cal&lt;/h2&gt;

&lt;p&gt;Using elpa, I installed the package:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;M-x package-list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Highlight the &lt;code class=&quot;highlighter-rouge&quot;&gt;org-gcal&lt;/code&gt; package and install.&lt;/p&gt;

&lt;h2 id=&quot;create-api-credentials&quot;&gt;Create Api Credentials&lt;/h2&gt;

&lt;p&gt;Then, go to google and get credentials to access your calendar. You will need to go to the &lt;a href=&quot;https://console.developers.google.com/cloud-resource-manager&quot;&gt;google developers portal&lt;/a&gt; where you may need to enable the developers’ api. You will need to find Api &amp;amp; Services and then click on credentials. You will create some OAuth 2.0 client IDs credentials - one being the API key and the other being a secret. Make a note of these, or download the JSON file that Google provides.&lt;/p&gt;

&lt;p&gt;&lt;a data-flickr-embed=&quot;true&quot; href=&quot;https://www.flickr.com/photos/kabads/26101808357/in/datetaken/&quot; title=&quot;Screenshot-2018-3-23 Credentials - org-gcal&quot;&gt;&lt;img src=&quot;https://farm1.staticflickr.com/799/26101808357_5446e2c69d.jpg&quot; width=&quot;500&quot; height=&quot;229&quot; alt=&quot;Screenshot-2018-3-23 Credentials - org-gcal&quot; /&gt;&lt;/a&gt;&lt;script async=&quot;&quot; src=&quot;//embedr.flickr.com/assets/client-code.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;Enable these credentials for Google Calendar.&lt;/p&gt;

&lt;p&gt;&lt;a data-flickr-embed=&quot;true&quot; href=&quot;https://www.flickr.com/photos/kabads/40931425052/in/datetaken/&quot; title=&quot;Screenshot-2018-3-23 APIs Services - org-gcal&quot;&gt;&lt;img src=&quot;https://farm1.staticflickr.com/818/40931425052_9051ec90df.jpg&quot; width=&quot;500&quot; height=&quot;241&quot; alt=&quot;Screenshot-2018-3-23 APIs Services - org-gcal&quot; /&gt;&lt;/a&gt;&lt;script async=&quot;&quot; src=&quot;//embedr.flickr.com/assets/client-code.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h2 id=&quot;identify-calendar&quot;&gt;Identify Calendar&lt;/h2&gt;

&lt;p&gt;Then, the README for org-cal tells you to find the link for your calendar. This didn’t work for me. Instead, I found the link in the url in the address bar of my browser (click on the image to see more detail):&lt;/p&gt;

&lt;p&gt;&lt;a data-flickr-embed=&quot;true&quot; href=&quot;https://www.flickr.com/photos/kabads/40263945734&quot; title=&quot;url&quot;&gt;&lt;img src=&quot;https://farm1.staticflickr.com/805/40263945734_3272338f4e_c.jpg&quot; width=&quot;800&quot; height=&quot;105&quot; alt=&quot;url&quot; /&gt;&lt;/a&gt;&lt;script async=&quot;&quot; src=&quot;//embedr.flickr.com/assets/client-code.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h2 id=&quot;create-settings&quot;&gt;Create settings&lt;/h2&gt;

&lt;p&gt;(require ‘org-gcal)
   (setq org-gcal-client-id “your-id-foo.apps.googleusercontent.com”
      org-gcal-client-secret “your-secret”
      org-gcal-file-alist ‘((“your-mail@gmail.com” .  “~/schedule.org”)
                            (“another-mail@gmail.com” .  “~/task.org”)))&lt;/p&gt;

&lt;p&gt;Copy that string in to your &lt;code class=&quot;highlighter-rouge&quot;&gt;~.emacs&lt;/code&gt; file, substituting the proper parts (your org-gcal-client-id and secret and the files that you wish to create when you sync).&lt;/p&gt;

&lt;p&gt;Save the file and then execute &lt;code class=&quot;highlighter-rouge&quot;&gt;M-x load-file &amp;lt;RET&amp;gt;.emacs&lt;/code&gt; to reload this file.&lt;/p&gt;

&lt;h2 id=&quot;sync-and-org-agenda-file-to-front&quot;&gt;Sync and org-agenda-file-to-front&lt;/h2&gt;

&lt;p&gt;Now you need to sync your calendar, which will create a new org file (as you specified in the settings.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;M-x org-gcal-sync
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once that file is created open it &lt;code class=&quot;highlighter-rouge&quot;&gt;C-x C-f&lt;/code&gt; &amp;lt;/path/to/file&amp;gt; &lt;RET&gt;` and then `M-x org-agenda-file-to-front`. This command will include the new file.&lt;/RET&gt;&lt;/p&gt;

&lt;p&gt;You can also create a hook to run &lt;code class=&quot;highlighter-rouge&quot;&gt;org-gcal-sync&lt;/code&gt; when you open your agenda by placing this snippet in your &lt;code class=&quot;highlighter-rouge&quot;&gt;.emacs&lt;/code&gt; file:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(add-hook 'org-agenda-mode-hook (lambda () (org-gcal-sync) ))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Cycle Jaunt Around Bath</title><link href="http://localhost:4000/cycling/2018/02/11/cycle-jaunt-around-bath.html" rel="alternate" type="text/html" title="Cycle Jaunt Around Bath" /><published>2018-02-11T19:20:30+00:00</published><updated>2018-02-11T19:20:30+00:00</updated><id>http://localhost:4000/cycling/2018/02/11/cycle-jaunt-around-bath</id><content type="html" xml:base="http://localhost:4000/cycling/2018/02/11/cycle-jaunt-around-bath.html">&lt;p&gt;Sunday involved a train ride to bath with a Brompton in fold, and then cycling around the Two Tunnels circular route. A quick stop at &lt;a href=&quot;http://hopeandanchormidford.co.uk&quot;&gt;The Hope and Anchor&lt;/a&gt; pub to avoid the sleet and get a quick half-way coffee, is highly recommended.&lt;/p&gt;

&lt;p&gt;&lt;a data-flickr-embed=&quot;true&quot; href=&quot;https://secure.flickr.com/photos/kabads/albums/72157669458021059&quot; title=&quot;Cycle Jaunt around Bath&quot;&gt;&lt;img src=&quot;https://farm5.staticflickr.com/4626/28426294529_b92230306f_z.jpg&quot; width=&quot;640&quot; height=&quot;640&quot; alt=&quot;Cycle Jaunt around Bath&quot; /&gt;&lt;/a&gt;&lt;script async=&quot;&quot; src=&quot;//embedr.flickr.com/assets/client-code.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/p&gt;</content><author><name></name></author><summary type="html">Sunday involved a train ride to bath with a Brompton in fold, and then cycling around the Two Tunnels circular route. A quick stop at The Hope and Anchor pub to avoid the sleet and get a quick half-way coffee, is highly recommended.</summary></entry></feed>